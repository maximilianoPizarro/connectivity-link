apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: workshop-pipelines

resources:
  # PVC for cache workspace (must be created first)
  - pvc-cache.yaml
  # Tasks must be created before Pipeline (sync-wave: 0)
  - tekton-tasks.yaml
  # Pipeline depends on Tasks (sync-wave: 1)
  - tekton-pipeline.yaml
  # Uncomment the line below if you want to use a static secret file
  # - nexus-secret.yaml

# Option 1: Use secretGenerator with literals (values in plain text - not recommended for production)
# secretGenerator:
#   - name: nexus-credentials
#     namespace: workshop-pipelines
#     literals:
#       - username=admin
#       - password=admin123
#     type: Opaque

# Option 2: Use secretGenerator with files (recommended - keep credentials in separate files)
# Create nexus-credentials.env file with:
#   username=admin
#   password=YOUR_PASSWORD
# Then uncomment:
# secretGenerator:
#   - name: nexus-credentials
#     namespace: workshop-pipelines
#     envs:
#       - nexus-credentials.env
#     type: Opaque

# Option 3: Use secretGenerator with .gitignore file (best practice)
# Create nexus-credentials.env file and add it to .gitignore
# Then uncomment the secretGenerator section below:
# secretGenerator:
#   - name: nexus-credentials
#     namespace: workshop-pipelines
#     envs:
#       - nexus-credentials.env
#     type: Opaque
#     options:
#       disableNameSuffixHash: false

# Note: 
# - The secretGenerator is commented out by default because nexus-credentials.env is in .gitignore
# - To use it: 
#   1. Create nexus-credentials.env file locally with your credentials
#   2. Uncomment the secretGenerator section above
#   3. The secret will be created automatically when applying with kubectl apply -k
# - For ArgoCD: Create the secret manually or use External Secrets Operator
#   kubectl create secret generic nexus-credentials \
#     --from-literal=username=admin \
#     --from-literal=password=YOUR_PASSWORD \
#     -n workshop-pipelines

